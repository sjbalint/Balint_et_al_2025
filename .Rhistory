filepath <- "L:/Public/Sawyer Balint/RStudio/wickford_cores/data/"
#filepath <- "C:/Users/sbalint/OneDrive - Environmental Protection Agency (EPA)/Profile/Desktop/Backup/Sawyer Balint/RStudio/wickford_cores/data/"
all_isotopes <- read_excel(paste0(filepath,"isotopes_tidy.xlsx"))
colnames(all_isotopes) <- c("Core","Location","Depth","Water","Bulk","Grainsize","d15N","%N","d13C.total","d13C.inorg","%C.total","%C.organic","%C.inorg","% inorg","C-N")
theme_set(theme_classic())
melted_isotopes <-
pivot_longer(all_isotopes,cols=4:ncol(all_isotopes)) %>%
drop_na(melted_isotopes)
melted_isotopes <- pivot_longer(all_isotopes,cols=4:ncol(all_isotopes)) %>%
drop_na(melted_isotopes)
#load libraries
library(readxl)
library(dplyr)
#import data
filepath <- "L:/Public/Sawyer Balint/RStudio/wickford_cores/data/"
#filepath <- "C:/Users/sbalint/OneDrive - Environmental Protection Agency (EPA)/Profile/Desktop/Backup/Sawyer Balint/RStudio/wickford_cores/data/"
all_isotopes <- read_excel(paste0(filepath,"isotopes_tidy.xlsx"))
colnames(all_isotopes) <- c("Core","Location","Depth","Water","Bulk","Grainsize","d15N","%N","d13C.total","d13C.inorg","%C.total","%C.organic","%C.inorg","% inorg","C-N")
theme_set(theme_classic())
melted_isotopes <- pivot_longer(all_isotopes,cols=4:ncol(all_isotopes))
melted_isotopes <- drop_na(melted_isotopes)
ggplot(all_isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name)+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[2,3,7,9]
melted_isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
isotopes <- all_isotopes[2,3,7,9]
isotopes <- all_isotopes[(2,3,7,9)]
isotopes <- all_isotopes["Location","Depth","d15N","d13C.total"]
isotopes <- all_isotopes[["Location","Depth","d15N","d13C.total"]]
isotopes <- all_isotopes[c("Location","Depth","d15N","d13C.total")]
View(isotopes)
melted_isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","d13C.total")]
melted_isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(all_isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name)+
theme(strip.background = element_blank())
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name)+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","d13C.total")]
melted_isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name)+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","d13C.total")]
isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name)+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","d13C.total")]
isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","Bulk")]
isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")+
theme(strip.background = element_blank())
theme_set(theme_classic())
isotopes <- all_isotopes[c("Location","Depth","d15N","%N")]
isotopes <- pivot_longer(isotopes,cols=3:ncol(isotopes))
ggplot(isotopes, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")+
theme(strip.background = element_blank())
theme_set(theme_classic())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")+
theme(strip.background = element_blank())
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")+
theme(strip.background = element_blank())
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "Bottom")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom")+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(A = "%N", V = "d15N (permil)") ) )+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(%N = "%N", d15N = "d15N (permil)") ) )+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)") ) )+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "$\delta 15N (permil)") ) )+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "$\delta$15N (permil)") ) )+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = paste0(expression(delta),"15N (permil)") ) )+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = paste0(expression(delta),"15N (permil)"))))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom" #,labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)")))+
ylab(NULL) +
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom")))+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom")))+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom"))+
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x", nrow=2,
strip.position = "bottom")+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.")]
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x",
strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(isotopes))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x",
strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)", `%C.organic` = "%C Organic",d13C.total = "d13C (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
View(subset)
subset <- pivot_longer(subset,cols=3:ncol(subset))
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(subset))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x",
strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)", `%C.organic` = "%C Organic",d13C.total = "d13C (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")
theme_set(theme_minimal())
subset <- all_isotopes[c("Location","Depth","d15N","%N", "d13C.total","%C.organic")]
subset <- pivot_longer(subset,cols=3:ncol(subset))
ggplot(subset, aes(x=Depth, y=value, group=Location, color=Location))+
geom_smooth()+
geom_point()+
coord_flip()+
scale_x_reverse()+
facet_wrap(~name, scales="free_x",
strip.position = "bottom",
labeller = as_labeller(c(`%N` = "%N", d15N = "d15N (permil)", `%C.organic` = "%C Organic",d13C.total = "d13C (permil)")))+
ylab(NULL) +
theme(strip.background = element_blank(), strip.placement = "outside")+
xlab("Depth (cm)")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#load libraries
library(readxl)
library(dplyr)
#import data
filepath <- "L:/Public/Sawyer Balint/RStudio/wickford_cores/data/"
#filepath <- "C:/Users/sbalint/OneDrive - Environmental Protection Agency (EPA)/Profile/Desktop/Backup/Sawyer Balint/RStudio/wickford_cores/data/"
all_cores <- read_excel(paste0(filepath,"grainsize_tidy.xlsx"))
#remove replicate information
all_cores[c(2,4:5)] <- NULL
library(G2Sd)
library(tidyverse)
library(xlsx)
#create a list of cores
core_list <- c("North", "Middle", "South")
#iterate over list
for (i in core_list){
temp_df <- subset(all_cores,Location==i)
temp_df[1] <- NULL
temp_df <- aggregate(temp_df,list(temp_df$Depth),mean)
depths <- temp_df$Depth
temp_df[1:3] <- NULL
temp_df <- as.data.frame(t(temp_df))
colnames(temp_df) <- depths
grandistrib(temp_df,main=i,xlab="Depth")
write.xlsx2(temp_df, paste0(filepath,"grainsize_wide.xlsx"), sheetName = i,
col.names = TRUE, row.names = TRUE, append = TRUE)
}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#load libraries
library(readxl)
library(dplyr)
#import data
filepath <- "L:/Public/Sawyer Balint/RStudio/wickford_cores/data/"
#filepath <- "C:/Users/sbalint/OneDrive - Environmental Protection Agency (EPA)/Profile/Desktop/Backup/Sawyer Balint/RStudio/wickford_cores/data/"
all_cores <- read_excel(paste0(filepath,"grainsize_tidy.xlsx"))
#remove replicate information
all_cores[c(2,4:5)] <- NULL
library(G2Sd)
library(tidyverse)
library(xlsx)
#create a list of cores
core_list <- c("North", "Middle", "South")
#iterate over list
for (i in core_list){
temp_df <- subset(all_cores,Location==i)
temp_df[1] <- NULL
temp_df <- aggregate(temp_df,list(temp_df$Depth),mean)
depths <- temp_df$Depth
temp_df[1:3] <- NULL
temp_df <- as.data.frame(t(temp_df))
colnames(temp_df) <- depths
grandistrib(temp_df,main=i,xlab="Depth")
#write.xlsx2(temp_df, paste0(filepath,"grainsize_wide.xlsx"), sheetName = i,
col.names = TRUE, row.names = TRUE, append = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#load libraries
library(readxl)
library(dplyr)
#import data
filepath <- "L:/Public/Sawyer Balint/RStudio/wickford_cores/data/"
#filepath <- "C:/Users/sbalint/OneDrive - Environmental Protection Agency (EPA)/Profile/Desktop/Backup/Sawyer Balint/RStudio/wickford_cores/data/"
all_cores <- read_excel(paste0(filepath,"grainsize_tidy.xlsx"))
#remove replicate information
all_cores[c(2,4:5)] <- NULL
library(G2Sd)
library(tidyverse)
library(xlsx)
#create a list of cores
core_list <- c("North", "Middle", "South")
#iterate over list
for (i in core_list){
temp_df <- subset(all_cores,Location==i)
temp_df[1] <- NULL
temp_df <- aggregate(temp_df,list(temp_df$Depth),mean)
depths <- temp_df$Depth
temp_df[1:3] <- NULL
temp_df <- as.data.frame(t(temp_df))
colnames(temp_df) <- depths
grandistrib(temp_df,main=i,xlab="Depth")
#write.xlsx2(temp_df, paste0(filepath,"grainsize_wide.xlsx"), sheetName = i, col.names = TRUE, row.names = TRUE, append = TRUE)
}
library(xlsx)
write.xlsx2(temp_df, paste0(filepath,"grainsize_wide.xlsx"), sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
#create a list of cores
grainsizes <- data.frame(c("Clay","Silt","C. Silt","V. F. Sand","F. Sand","Sand","C. Sand","V. C. Sand","V. F. Gravel"),c(3,30,60,120,270,500,1000,2000,4000))
colnames(grainsizes) <- c("Classification","Micrometers")
core_list <- c("North", "Middle", "South")
all_cores_class <- data.frame(matrix(nrow=0,ncol=6))
#iterate over list
for (i in core_list){
temp_df <- subset(all_cores,Location==i)
temp_df[1] <- NULL
temp_df <- aggregate(temp_df,list(temp_df$Depth),mean)
temp_df[1] <- NULL
temp_df <- pivot_longer(temp_df,!Depth,names_to="Grainsize",values_to="Percentage")
temp_df$Grainsize <- as.numeric(as.character(temp_df$Grainsize))
temp_df$Class <- NA
for (x in 1:nrow(temp_df)){
for (y in 1:nrow(grainsizes)){
if (temp_df$Grainsize[x]<grainsizes[y,2]){
temp_df$Class[x] <- grainsizes[y,1]
break
}
}
}
temp_df$Location <- i
if (i == "North"){
temp_df$Core <- "AC2"
}
if (i == "Middle"){
temp_df$Core <- "M6"
}
if (i == "South"){
temp_df$Core <- "S3"
}
all_cores_class <- rbind(all_cores_class,temp_df)
all_cores_class$Class <- factor(all_cores_class$Class,
levels=c("Clay","Silt","C. Silt","V. F. Sand","F. Sand","Sand","C. Sand","V. C. Sand","V. F. Gravel"))
all_cores_class$Location <- factor(all_cores_class$Location,
levels=c("North","Middle","South"))
}
library(xlsx)
write.xlsx2(all_cores_class, paste0(filepath,"grainsize_long.xlsx"), sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
library(RColorBrewer)
theme_set(theme_classic())
ggplot(all_cores_class, aes(x=Depth,y=Percentage, fill=Class))+
geom_bar(position="fill",stat="identity",width=2)+
coord_flip()+
scale_x_reverse()+
scale_fill_brewer(palette="Spectral")+
facet_wrap(~Location)+
theme(strip.background = element_blank())
all_cores <- read_excel("data/grainsize_tidy.xlsx")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#import data
all_isotopes <- read_excel("data/isotopes_tidy.xlsx")
